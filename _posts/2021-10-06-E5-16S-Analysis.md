---
layout: post
title: E5 16S Analysis
date: '2021-10-06'
categories: Processing
tags: 16S, E5, bioinformatics
projects: E5
---

# 16S Analysis for Mo'orea E5 project

12 test samples from the Mo'orea E5 project. Used my pipeline from Holobiont Integration project (found [here](https://github.com/emmastrand/EmmaStrand_Notebook/blob/master/_posts/2021-06-21-16s-Analysis-Pipeline.md)).

Primers used:  
- 515F:  GTGYCAGCMGCCGCGGTAA  
- 806RB: GGACTACNVGGGTWTCTAAT

Modules needed:  
- FastQC/0.11.9-Java-11  
- MultiQC/1.9-intel-2020a-Python-3.8.2   
- QIIME2/2021.4  

## Secure copy paste 12 files to bluewaves server

Ran outside of bluewaves / before logging into bluewaves and andromeda.

```
$ scp -r /Users/emmastrand/MyProjects/EmmaStrand_Notebook/16S_E5/raw_files emma_strand@bluewaves.uri.edu:/data/putnamlab/estrand/16S_E5
```

## FastQC

#### Build and run  fastqc script

Script: putnamlab/estrand/16S_E5/scripts/fastqc.sh

```
# within 16S_E5 folder
$ mkdir fastqc_results
```

Ran below script.

```
#!/bin/bash
#SBATCH -t 24:00:00
#SBATCH --nodes=1 --ntasks-per-node=1
#SBATCH --export=NONE
#SBATCH --mem=100GB
#SBATCH --mail-type=BEGIN,END,FAIL #email you when job starts, stops and/or fails
#SBATCH --mail-user=emma_strand@uri.edu #your email to send notifications
#SBATCH --account=putnamlab
#SBATCH -D /data/putnamlab/estrand/16S_E5/raw_files                  
#SBATCH --error="script_error" #if your job fails, the error report will be put in this file
#SBATCH --output="output_script" #once your job is completed, any final job report comments will be put in this file

source /usr/share/Modules/init/sh # load the module function

module load FastQC/0.11.9-Java-11
module load MultiQC/1.9-intel-2020a-Python-3.8.2

for file in /data/putnamlab/estrand/16S_E5/raw_files/*fastq.gz
do
fastqc $file --outdir /data/putnamlab/estrand/16S_E5/fastqc_results         
done

multiqc --interactive /data/putnamlab/estrand/16S_E5/fastqc_results  

mv multiqc_report.html 16S_raw_qc_multiqc_report_E5.html #renames file
```

Double check all files were processed. Output should be 12 x 2 (F and R reads) x 2 (html and zip file) = 48.

```
$ cd /data/putnamlab/estrand/16S_E5/fastqc_results
$ ls -1 | wc -l

output:
48
```

Copy and paste to notebook (outside of andromeda in a new terminal tab)

```
$ scp emma_strand@bluewaves.uri.edu:/data/putnamlab/estrand/16S_E5/raw_files/16S_raw_qc_multiqc_report_E5.html /Users/emmastrand/MyProjects/EmmaStrand_Notebook/16S_E5/
```

Link to full report: [Emma Strand Github Notebook](https://github.com/emmastrand/EmmaStrand_Notebook/blob/master/16S_E5/16S_raw_qc_multiqc_report_E5.html)

#### Raw QC Results

**Download the full multiqc report from the link above to view all aspects of quality assessment.**  
**Check duplicated reads and per sequence GC content specifically from this report.**

Mean Quality Scores: Red = R1 (forward). Blue = R2 (reverse)

![quality](https://github.com/emmastrand/EmmaStrand_Notebook/blob/master/16S_E5/mean-quality-scores.png?raw=true)

The quality scores will be what I based the trimming and truncating steps in the QIIME2 pipeline off of.

## QIIME2

Create metadata directory

```
$ cd /data/putnamlab/estrand/16S_E5
$ mkdir metadata
```

#### Creating metadata files from list of raw_files and in R

R Script link: [Emma Strand Notebook link]()

Create list of file names in andromeda.

```
$ cd 16S_E5
$ find raw_files -type f -print | sed 's_/_,_g' > ~/filelist.csv
$ mv ~/filelist.csv /data/putnamlab/estrand/16S_E5
```

Move that file to desktop to be able to run in R.

```
scp emma_strand@bluewaves.uri.edu:/data/putnamlab/estrand/16S_E5/filelist.csv /Users/emmastrand/MyProjects/EmmaStrand_Notebook/16S_E5/
```
